<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Nunchucks Go</title>
  <link rel="stylesheet" href="./assets/styles.css" />
</head>
<body>
  <main class="wrapper">
    <nav>
      <a href="./index.html">Overview</a>
      <a href="./golang.html">Go Library</a>
    </nav>

    <section class="hero">
      <h1>Go Library</h1>
      <p>Package: <code>github.com/SamuelDBines/nunjucks/go</code></p>
    </section>

    <section class="card" style="margin-top:1rem;">
      <h2>Quick Start</h2>
<pre><code class="language-go">env := nunchucks.Configure(nunchucks.ConfigOptions{Path: "views"})
out, err := env.Render("index.njk", map[string]any{
    "title": "Nunchucks",
    "items": []any{"alpha", "beta"},
})
if err != nil {
    panic(err)
}
fmt.Println(out)</code></pre>
    </section>

    <section class="card" style="margin-top:1rem;">
      <h2>CLI</h2>
<pre><code class="language-bash">go run ./cmd/nunchucks help
go run ./cmd/nunchucks render -views ./views -template index.njk -data '{"title":"Hello"}'
go run ./cmd/nunchucks precompile -views ./views -out ./public -data '{"title":"Hello"}'</code></pre>
    </section>

    <section class="card" style="margin-top:1rem;">
      <h2>Examples</h2>
<pre><code class="language-bash">cd go
go run ./examples/basic
go run ./examples/advanced</code></pre>
    </section>

    <section class="card" style="margin-top:1rem;">
      <h2>Detailed Example A: Template Composition</h2>
<pre><code class="language-njk"># views/layout.njk
&lt;h1&gt;{% block title %}Title{% endblock %}&lt;/h1&gt;
&lt;main&gt;{% block body %}{% endblock %}&lt;/main&gt;

# views/macros.njk
{% macro badge(text) %}&lt;span class="badge"&gt;{{ text | upper }}&lt;/span&gt;{% endmacro %}

# views/home.njk
{% extends "layout.njk" %}
{% import "macros.njk" as ui %}
{% block title %}Users{% endblock %}
{% block body %}
  {% for u in users %}
    {{ ui.badge(u.name) }}
  {% endfor %}
{% endblock %}</code></pre>
<pre><code class="language-go">env := nunchucks.Configure(nunchucks.ConfigOptions{Path: "views"})
out, err := env.Render("home.njk", map[string]any{
  "users": []any{
    map[string]any{"name": "sam"},
    map[string]any{"name": "kai"},
  },
})
if err != nil { panic(err) }</code></pre>
    </section>

    <section class="card" style="margin-top:1rem;">
      <h2>Detailed Example B: Filter + Function Parity</h2>
<pre><code class="language-njk">{% set active = users | selectattr("active") %}
Active={{ active | length }}

{% for grp in users | groupby("role", "none") %}
{{ grp.grouper }}={{ grp.list | length }}
{% endfor %}

BestScoreKey={{ scores | dictsort("value", false, true) | first | first }}
Intervals={{ range(0, 10, 3) | join(",") }}</code></pre>
<pre><code class="language-go">out, err := env.Render("report.njk", map[string]any{
  "users": []any{
    map[string]any{"name":"A","active":true,"role":"Dev"},
    map[string]any{"name":"B","active":false,"role":"ops"},
    map[string]any{"name":"C","active":true,"role":"dev"},
  },
  "scores": map[string]any{"x": 4, "y": 7, "z": 2},
})</code></pre>
    </section>

    <section class="grid">
      <article class="card">
        <h3>Implemented</h3>
        <ul>
          <li><code>Configure</code></li>
          <li><code>Render(name, ctx)</code></li>
          <li><code>RenderString(src, ctx)</code></li>
          <li><code>include</code>, <code>extends</code>, blocks, <code>super()</code></li>
          <li><code>set</code>, <code>if</code>, <code>for</code>, <code>{{ expr }}</code></li>
          <li><code>macro</code>, <code>import ... as</code>, <code>call</code></li>
          <li><code>raw</code>, <code>verbatim</code>, <code>filter ... endfilter</code></li>
        </ul>
      </article>
      <article class="card">
        <h3>Expression Support</h3>
        <ul>
          <li>Literals: string, number, bool, nil</li>
          <li>Dot-path lookup from context or vars</li>
          <li>Filters: <code>lower</code>, <code>upper</code></li>
        </ul>
      </article>
    </section>

    <section class="card" style="margin-top:1rem;">
      <h2>WASM Target</h2>
      <p>The Go core can be compiled to WebAssembly and consumed from JS runtimes.</p>
<pre><code class="language-bash">cd go
GOOS=js GOARCH=wasm go build -o wasm/nunchucks.wasm ./cmd/nunchucks-wasm
cp "$(go env GOROOT)/lib/wasm/wasm_exec.js" wasm/wasm_exec.js</code></pre>
      <p>Then load with <code>go/wasm/loader.js</code> and call:</p>
      <ul>
        <li><code>renderFromMap({ template, files, context })</code></li>
        <li><code>renderString({ source, context })</code></li>
      </ul>
    </section>
  </main>
</body>
</html>
